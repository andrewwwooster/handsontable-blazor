@page "/"

<PageTitle>Home</PageTitle>

<h1>Hello, world!</h1>

<p>@_onChangeValue</p>
<button @onclick="AddRow">Add Row</button>

<Handsontable.Blazor.Handsontable 
        Id="hot" 
        Data="@_data" 
        OnAfterChange="@OnAfterChange"
        @ref="_handsontable" />

@code
{
    Handsontable.Blazor.Handsontable? _handsontable;

    private string _onChangeValue = string.Empty;

    object[][] _data =
    {
        new object[] { "A1", "B1", "C1" },
        new object[] { "A2", "B2", "C2" },
        new object[] { "A3", "B3", "C3" }
    };

    private async Task AddRow()
    {
        await _handsontable!.HandsontableJsInterop!.Alter(
            Handsontable.Blazor.HandsontableJsInterop.AlterActionEnum.insert_row_above, 0);
    }

    private async Task OnAfterChange(Handsontable.Blazor.HandsontableJsInterop.AfterChangeArgs args)
    {
        _onChangeValue = $"OnAfterChange: {args.Data[0][0]} {args.Data[0][1]} {args.Data[0][2]} {args.Data[0][3]} {args.Source}";
        StateHasChanged();
        await Task.CompletedTask;
    }
}

